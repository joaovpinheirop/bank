<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Google+Sans:ital,opsz,wght@0,17..18,400..700;1,17..18,400..700&display=swap" rel="stylesheet">
    
    
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=BBH+Bartle&display=swap" rel="stylesheet">
    <title>LIZO BANK</title>
    <style>

        :root {
  --cor-principal: #ff6200;
  --cor-secundaria: #2ecc71;
  --espacamento-padrao: 20px;
  --fonte-titulo: 'Roboto', sans-serif;
}
    body {  display: flex;
    flex-direction: column;
    align-items: center;
    background-color: rgb(42, 42, 42) !important;
     font-family: "Google Sans", sans-serif;
  font-optical-sizing: auto
 
    }
    #nomeBusca{
    display: none;
    }
    
    .bbh-bartle-regular {
  font-family: "BBH Bartle", sans-serif;
  font-weight: 400;
  font-style: normal;
}

.saldo-gigante{
  font-family: "BBH Bartle", sans-serif;
    font-size: 30px;
    margin: 20PX 0PX;
}
h1,h3{
    font-family: "BBH Bartle", sans-serif;
  font-weight: 400;
  font-style: normal;
  color: rgb(255, 255, 255);
}


.container{
    color: white;
    border-radius: 20PX;
     font-weight: 800;
    width: 90%;  
    display: flex;
    margin: 10px;
    flex-direction: column;
    padding: 21px;
   
}
.design{
      display: flex;
    align-items: center;
   border-radius: 20PX;
    width: 90%; 
    display: flex;
    flex-direction: column;
    padding: 21px;background-color:var(--cor-principal) ;
}
.user{
    
    width: 90%;
}
#resNome{
    color: rgb(255, 255, 255);
}
#UseName{
    
    color: white;
}
button{
    background-color:var(--cor-principal)  ;
    border-radius: 100px;
    border: 0;
    padding: 10px;
    width: 100PX;
  color: rgb(255, 255, 255);
  
}
.emprestimo{
    display: flex;
    flex-direction: column;
    background-color:rgb(76, 76, 76) ;
    justify-content: center;
    align-items: center;
    border-radius: 10px;
    border: 0;
    padding: 10px;
    height: 100px;
  font-weight: 400;
  font-style: normal;
  margin: 10px 0px;
  color: rgb(255, 255, 255);
}

.carrossel {
    width: 100%;
    max-width: 400px; /* Largura do celular */
    margin: 20px auto;
    overflow: hidden;
    border-radius: 15px;
}

.slides {
    display: flex;
    overflow-x: auto;
    scroll-snap-type: x mandatory; /* Faz as imagens "travarem" no lugar */
    scroll-behavior: smooth;
    -webkit-overflow-scrolling: touch;
}

/* Esconde a barra de rolagem para ficar mais limpo */
.slides::-webkit-scrollbar {
    display: none;
}

.slide {
    flex: 0 0 100%; /* Cada imagem ocupa 100% da largura do carrossel */
    scroll-snap-align: start;
}

.slide img {
    width: 100%;
    display: block;
    object-fit: cover;
}

#direitos{
    font-family: "BBH Bartle", sans-serif;
    font-size: 10px;
    margin: 20px;
  color: var(--cor-principal);
}
    </style>
</head>
<body>
     <h3>LISO BANK</h3>

    <div class="design">
        
        <h1 id="resNome">LISO BANK</h1>
        
    </div>
    
<div class="container">

    <input type="text" id="nomeBusca" placeholder="Digite seu nome (Ex: Joao)">

    <div id="resultado" style="display: none;">
        <div class="status-box">
            SALDO
            <div class="saldo-gigante">R$ <span id="resSaldo">0</span></div>
            <button>PIx</button>
            <button>Pagar</button>
            <button>cartao</button>
        </div>
    </div>
    
    <div class="emprestimo">Boas notícias! Analisamos seu perfil e liberamos um limite pré-aprovado de R$ 0,00. Use com moderação!</div>
    <p>Compras: <span id="resCompras" class="lista-compras">---</span></p>
</div>
<div class="carrossel">
    <div class="slides" id="lista-slides">
        <div class="slide"><img src="https://joaovpinheiros.vercel.app/img/Bank/p1.png"></div>
        <div class="slide"><img src="https://joaovpinheiros.vercel.app/img/Bank/p2.png"></div>
        <div class="slide"><img src="https://joaovpinheiros.vercel.app/img/Bank/p3.png"></div>
        <div class="slide"><img src="https://joaovpinheiros.vercel.app/img/Bank/p4.png"></div>
        <div class="slide"><img src="https://joaovpinheiros.vercel.app/img/Bank/p5.png"></div>
    </div>
</div>

<p id="direitos">todos os direitos reservados a LISO BANK &copy; 2024</p>

<script>
    // Função executada assim que a página abre
    window.onload = () => {
        const caminho = window.location.pathname; // Pega "/bank/Joao"
        const partes = caminho.split('/');
        const nomeDaUrl = partes[partes.length - 1]; // Pega apenas "Joao"

        if (nomeDaUrl && nomeDaUrl !== 'index.html') {
            document.getElementById('nomeBusca').value = decodeURIComponent(nomeDaUrl);
            
            // Inicia a busca imediata
            buscarDados();

            // Configura para atualizar AUTOMATICAMENTE a cada 2 segundos
            console.log("Monitorando saldo para: " + nomeDaUrl);
            setInterval(() => {
                buscarDados(true); // Passamos true para evitar alertas de erro na tela
            }, 2000);
        }
    };

    async function buscarDados(silencioso = false) {
        const nomeInput = document.getElementById('nomeBusca').value.trim();
        if (!nomeInput) return;

        try {
            const response = await fetch('/api/jogadores');
            const jogadores = await response.json();
            
            const j = jogadores.find(item => item.nome.toLowerCase() === nomeInput.toLowerCase());

            if (j) {
                // Atualiza os campos na tela
                document.getElementById('resNome').innerText = j.nome;
                document.getElementById('resSaldo').innerText = j.saldo.toLocaleString('pt-BR', { minimumFractionDigits: 2 });
                document.getElementById('resCompras').innerText = j.compras.length > 0 ? j.compras.join(', ') : "Nenhum item";
                
                document.getElementById('resultado').style.display = 'block';
            } else if (!silencioso) {
                alert("Jogador não encontrado!");
            }
        } catch (e) {
            if (!silencioso) console.error("Erro ao conectar com o servidor.");
        }
    }

    // Função para o Admin (se necessário nesta página)
    async function registrarVenda() {
        const nome = document.getElementById('nomeBusca').value.trim();
        const valor = parseFloat(document.getElementById('lanceValor').value);
        const item = document.getElementById('lanceItem').value;

        if (!nome || !valor || !item) return alert("Preencha tudo!");

        const response = await fetch('/api/lance', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ nome, valor, item })
        });

        const data = await response.json();
        if (data.sucesso) {
            buscarDados(true);
        } else {
            alert(data.erro);
        }
    }

    const slides = document.getElementById('lista-slides');
let index = 0;

function passarSlide() {
    const totalSlides = slides.children.length;
    index++;

    // Se chegar no último, volta para o primeiro
    if (index >= totalSlides) {
        index = 0;
    }

    // Calcula a largura de um slide e faz o scroll
    const larguraSlide = slides.children[0].offsetWidth;
    slides.scrollTo({
        left: larguraSlide * index,
        behavior: 'smooth'
    });
}

// Configura para passar a cada 3 segundos (3000 milissegundos)
setInterval(passarSlide, 15000);
</script>

</body>
</html>